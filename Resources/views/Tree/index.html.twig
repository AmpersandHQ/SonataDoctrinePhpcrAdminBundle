{#

This file is part of the Sonata package.

(c) Thomas Rabaix <thomas.rabaix@sonata-project.org>

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.

#}

{% extends base_template %}

{% block title %}{% trans from 'SonataAdminBundle' %}title_tree{% endtrans %}{% endblock%}
{% block breadcrumb %}{% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('bundles/symfonycmftree/css/jquery.treeview.css') }}" type="text/css" media="all" />
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% include 'SymfonyCmfPHPCRBrowserBundle:Base:tree.html.twig' %}
            <script type="text/javascript">
                $(document).ready(function() {
                    initTree({
                        "selector": "#tree",
                        "contentselector": ".sonata-ba-content",
                        "path": {
                            "expanded":     [ "/cms" ],
                            "preloaded":    [ "/cms" ],
                        },
                        "icon": {
                            "document": "{{ asset('bundles/symfonycmftree/images/document.png') }}",
                            "folder":   "{{ asset('bundles/symfonycmftree/images/folder.png') }}"
                        },
                        "route": {
                            "edit":     'admin_sandbox_main_editablestaticcontent_edit',
                            "erase":    'admin_sandbox_main_editablestaticcontent_delete'
                        },
                        "routecollection": {
                            {% for handler in handlers %}
                                "{{handler.className}}" :{
                                    "label" : "{{ handler.label }}",
                                    "routes" : {
                                        {% for code, path in handler.routes %}
                                            "{{ code }}" : "{{ path }}",
                                        {% endfor%}
                                    }
                                },
                            {% endfor%}
                        },
                        "doctypes": {
                            {% for handler in handlers %}
                                "{{ handler.label }}": {
                                    "label": "{{handler.label}}",
                                    "action": function (node) {
                                        $('.sonata-ba-content').load( Routing.generate( '{{handler.routes.create}}', { "id": node.attr("id") }));
                                    }
                                },
                            {% endfor %}
                        }
                    });
                });
            </script>
{% endblock %}

{% block side_menu %}
    <div id="tree"></div>
    {{ parent() }}
{% endblock %}
{% block content %}

{% endblock %}

